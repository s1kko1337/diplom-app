function createSensors(overrides = {}) {
  const base = {
    'temp-engine': {
      id: 'temp-engine',
      type: 'temperature',
      label: 'Температура двигателя',
      unit: '°C',
      min: 0,
      max: 120,
      thresholds: { warning: 80, critical: 95 },
      currentValue: 78,
    },
    speed: {
      id: 'speed',
      type: 'speed',
      label: 'Скорость вращения',
      unit: 'RPM',
      min: 0,
      max: 3000,
      thresholds: { warning: 2600, critical: 2800 },
      currentValue: 2200,
    },
    depth: {
      id: 'depth',
      type: 'depth',
      label: 'Глубина бурения',
      unit: 'м',
      min: 0,
      max: 300,
      thresholds: { warning: 250, critical: 290 },
      currentValue: 45,
    },
    pressure: {
      id: 'pressure',
      type: 'pressure',
      label: 'Давление',
      unit: 'БАР',
      min: 0,
      max: 150,
      thresholds: { warning: 130, critical: 145 },
      currentValue: 120,
    },
    vibration: {
      id: 'vibration',
      type: 'vibration',
      label: 'Вибрация',
      unit: 'мм/с',
      min: 0,
      max: 3,
      thresholds: { warning: 1.5, critical: 2.5 },
      currentValue: 0.8,
    },
    power: {
      id: 'power',
      type: 'power',
      label: 'Мощность',
      unit: '%',
      min: 0,
      max: 100,
      thresholds: { warning: 90, critical: 95 },
      currentValue: 85,
    },
    torque: {
      id: 'torque',
      type: 'torque',
      label: 'Крутящий момент',
      unit: 'Нм',
      min: 0,
      max: 600,
      thresholds: { warning: 450, critical: 550 },
      currentValue: 340,
    },
    'fuel-rate': {
      id: 'fuel-rate',
      type: 'fuelRate',
      label: 'Расход топлива',
      unit: 'Л/Ч',
      min: 0,
      max: 30,
      thresholds: { warning: 22, critical: 27 },
      currentValue: 18,
    },
    'tool-wear': {
      id: 'tool-wear',
      type: 'toolWear',
      label: 'Износ долота',
      unit: '%',
      min: 0,
      max: 100,
      thresholds: { warning: 70, critical: 90 },
      currentValue: 55,
    },
    'oil-level': {
      id: 'oil-level',
      type: 'oilLevel',
      label: 'Уровень масла',
      unit: '%',
      min: 0,
      max: 100,
      thresholds: { warning: 30, critical: 15 },
      currentValue: 92,
    },
    'oil-temp': {
      id: 'oil-temp',
      type: 'oilTemp',
      label: 'Температура гидромасла',
      unit: '°C',
      min: 0,
      max: 80,
      thresholds: { warning: 65, critical: 75 },
      currentValue: 55,
    },
    'engine-load': {
      id: 'engine-load',
      type: 'engineLoad',
      label: 'Загрузка двигателя',
      unit: '%',
      min: 0,
      max: 100,
      thresholds: { warning: 90, critical: 97 },
      currentValue: 84,
    },
  }

  for (const [key, values] of Object.entries(overrides)) {
    if (base[key]) {
      Object.assign(base[key], values)
    }
  }

  return Object.values(base)
}

export const equipmentDb = {
  'БУР-12': {
    id: 'БУР-12',
    model: 'СБШ-250МНА',
    fullModel: 'Буровой станок СБШ-250МНА',
    serial: 'E-2024-012',
    year: 2023,
    status: 'working',
    statusLabel: 'В РАБОТЕ',
    sensors: createSensors({
      'temp-engine': { currentValue: 82 },
      speed: { currentValue: 2340 },
      depth: { currentValue: 45.3 },
      pressure: { currentValue: 124 },
      vibration: { currentValue: 0.85 },
      power: { currentValue: 87 },
      torque: { currentValue: 340 },
      'fuel-rate': { currentValue: 18.5 },
      'tool-wear': { currentValue: 62 },
      'oil-level': { currentValue: 94 },
      'oil-temp': { currentValue: 58 },
      'engine-load': { currentValue: 87 },
    }),
    specs: [
      { label: 'Модель', value: 'СБШ-250МНА' },
      { label: 'Серийный номер', value: 'SN-2024-0812' },
      { label: 'Год выпуска', value: '2023' },
      { label: 'Макс. глубина бурения', value: '250 м' },
      { label: 'Диаметр бурения', value: '76-250 мм' },
      { label: 'Мощность двигателя', value: '132 кВт' },
      { label: 'Макс. крутящий момент', value: '400 Нм' },
    ],
    serviceHistory: [
      { date: '2026-02-10', type: 'Плановое ТО', status: 'Завершено' },
      { date: '2026-01-28', type: 'Замена долота', status: 'Завершено' },
      { date: '2026-01-15', type: 'Диагностика', status: 'Завершено' },
      { date: '2025-12-20', type: 'Плановое ТО', status: 'Завершено' },
    ],
  },
  'БУР-08': {
    id: 'БУР-08',
    model: 'СБШ-250МНА',
    fullModel: 'Буровой станок СБШ-250МНА',
    serial: 'E-2024-008',
    year: 2023,
    status: 'working',
    statusLabel: 'В РАБОТЕ',
    sensors: createSensors({
      'temp-engine': { currentValue: 78 },
      speed: { currentValue: 2180 },
      depth: { currentValue: 38.7 },
      pressure: { currentValue: 118 },
      vibration: { currentValue: 0.72 },
      power: { currentValue: 82 },
      torque: { currentValue: 310 },
      'fuel-rate': { currentValue: 16.8 },
      'tool-wear': { currentValue: 45 },
      'oil-level': { currentValue: 91 },
      'oil-temp': { currentValue: 54 },
      'engine-load': { currentValue: 82 },
    }),
    specs: [
      { label: 'Модель', value: 'СБШ-250МНА' },
      { label: 'Серийный номер', value: 'SN-2024-0808' },
      { label: 'Год выпуска', value: '2023' },
      { label: 'Макс. глубина бурения', value: '250 м' },
      { label: 'Диаметр бурения', value: '76-250 мм' },
      { label: 'Мощность двигателя', value: '132 кВт' },
      { label: 'Макс. крутящий момент', value: '400 Нм' },
    ],
    serviceHistory: [
      { date: '2026-02-05', type: 'Диагностика', status: 'Завершено' },
      { date: '2026-01-20', type: 'Плановое ТО', status: 'Завершено' },
      { date: '2025-12-10', type: 'Замена фильтров', status: 'Завершено' },
    ],
  },
  'БУР-15': {
    id: 'БУР-15',
    model: 'DML-1200',
    fullModel: 'Буровой станок DML-1200',
    serial: 'E-2024-015',
    year: 2022,
    status: 'idle',
    statusLabel: 'ПРОСТОЙ',
    sensors: createSensors({
      'temp-engine': { currentValue: 45 },
      speed: { currentValue: 0 },
      depth: { currentValue: 52.1 },
      pressure: { currentValue: 0 },
      vibration: { currentValue: 0 },
      power: { currentValue: 0 },
      torque: { currentValue: 0 },
      'fuel-rate': { currentValue: 0 },
      'tool-wear': { currentValue: 78 },
      'oil-level': { currentValue: 88 },
      'oil-temp': { currentValue: 32 },
      'engine-load': { currentValue: 0 },
    }),
    specs: [
      { label: 'Модель', value: 'DML-1200' },
      { label: 'Серийный номер', value: 'SN-2024-1215' },
      { label: 'Год выпуска', value: '2022' },
      { label: 'Макс. глубина бурения', value: '300 м' },
      { label: 'Диаметр бурения', value: '150-311 мм' },
      { label: 'Мощность двигателя', value: '200 кВт' },
      { label: 'Макс. крутящий момент', value: '600 Нм' },
    ],
    serviceHistory: [
      { date: '2026-02-14', type: 'Внеплановый ремонт', status: 'Ожидание запчастей' },
      { date: '2026-01-30', type: 'Плановое ТО', status: 'Завершено' },
    ],
  },
  'БУР-03': {
    id: 'БУР-03',
    model: 'СБШ-320',
    fullModel: 'Буровой станок СБШ-320',
    serial: 'E-2024-003',
    year: 2024,
    status: 'malfunction',
    statusLabel: 'НЕИСПРАВНОСТЬ',
    sensors: createSensors({
      'temp-engine': { currentValue: 95 },
      speed: { currentValue: 2510 },
      depth: { currentValue: 61.8 },
      pressure: { currentValue: 142 },
      vibration: { currentValue: 1.8 },
      power: { currentValue: 98 },
      torque: { currentValue: 480 },
      'fuel-rate': { currentValue: 24.2 },
      'tool-wear': { currentValue: 89 },
      'oil-level': { currentValue: 72 },
      'oil-temp': { currentValue: 76 },
      'engine-load': { currentValue: 98 },
    }),
    specs: [
      { label: 'Модель', value: 'СБШ-320' },
      { label: 'Серийный номер', value: 'SN-2024-0303' },
      { label: 'Год выпуска', value: '2024' },
      { label: 'Макс. глубина бурения', value: '320 м' },
      { label: 'Диаметр бурения', value: '200-320 мм' },
      { label: 'Мощность двигателя', value: '180 кВт' },
      { label: 'Макс. крутящий момент', value: '500 Нм' },
    ],
    serviceHistory: [
      { date: '2026-02-16', type: 'Аварийная остановка', status: 'В процессе' },
      { date: '2026-02-01', type: 'Плановое ТО', status: 'Завершено' },
      { date: '2026-01-10', type: 'Замена долота', status: 'Завершено' },
    ],
  },
  'БУР-21': {
    id: 'БУР-21',
    model: 'DML-1200',
    fullModel: 'Буровой станок DML-1200',
    serial: 'E-2024-021',
    year: 2024,
    status: 'working',
    statusLabel: 'В РАБОТЕ',
    sensors: createSensors({
      'temp-engine': { currentValue: 73 },
      speed: { currentValue: 2220 },
      depth: { currentValue: 29.4 },
      pressure: { currentValue: 115 },
      vibration: { currentValue: 0.65 },
      power: { currentValue: 79 },
      torque: { currentValue: 290 },
      'fuel-rate': { currentValue: 15.3 },
      'tool-wear': { currentValue: 38 },
      'oil-level': { currentValue: 96 },
      'oil-temp': { currentValue: 51 },
      'engine-load': { currentValue: 79 },
    }),
    specs: [
      { label: 'Модель', value: 'DML-1200' },
      { label: 'Серийный номер', value: 'SN-2024-1221' },
      { label: 'Год выпуска', value: '2024' },
      { label: 'Макс. глубина бурения', value: '300 м' },
      { label: 'Диаметр бурения', value: '150-311 мм' },
      { label: 'Мощность двигателя', value: '200 кВт' },
      { label: 'Макс. крутящий момент', value: '600 Нм' },
    ],
    serviceHistory: [
      { date: '2026-02-12', type: 'Плановое ТО', status: 'Завершено' },
      { date: '2026-01-25', type: 'Диагностика', status: 'Завершено' },
    ],
  },
  'БУР-17': {
    id: 'БУР-17',
    model: 'СБШ-250МНА',
    fullModel: 'Буровой станок СБШ-250МНА',
    serial: 'E-2024-017',
    year: 2023,
    status: 'working',
    statusLabel: 'В РАБОТЕ',
    sensors: createSensors({
      'temp-engine': { currentValue: 76 },
      speed: { currentValue: 2290 },
      depth: { currentValue: 41.2 },
      pressure: { currentValue: 120 },
      vibration: { currentValue: 0.78 },
      power: { currentValue: 84 },
      torque: { currentValue: 325 },
      'fuel-rate': { currentValue: 17.1 },
      'tool-wear': { currentValue: 52 },
      'oil-level': { currentValue: 93 },
      'oil-temp': { currentValue: 55 },
      'engine-load': { currentValue: 84 },
    }),
    specs: [
      { label: 'Модель', value: 'СБШ-250МНА' },
      { label: 'Серийный номер', value: 'SN-2024-0817' },
      { label: 'Год выпуска', value: '2023' },
      { label: 'Макс. глубина бурения', value: '250 м' },
      { label: 'Диаметр бурения', value: '76-250 мм' },
      { label: 'Мощность двигателя', value: '132 кВт' },
      { label: 'Макс. крутящий момент', value: '400 Нм' },
    ],
    serviceHistory: [
      { date: '2026-02-08', type: 'Замена фильтров', status: 'Завершено' },
      { date: '2026-01-18', type: 'Плановое ТО', status: 'Завершено' },
    ],
  },
  'БУР-05': {
    id: 'БУР-05',
    model: 'DML-1200',
    fullModel: 'Буровой станок DML-1200',
    serial: 'E-2024-005',
    year: 2022,
    status: 'offline',
    statusLabel: 'ОТКЛЮЧЕНО',
    sensors: createSensors({
      'temp-engine': { currentValue: 38 },
      speed: { currentValue: 0 },
      depth: { currentValue: 48.9 },
      pressure: { currentValue: 0 },
      vibration: { currentValue: 0 },
      power: { currentValue: 0 },
      torque: { currentValue: 0 },
      'fuel-rate': { currentValue: 0 },
      'tool-wear': { currentValue: 85 },
      'oil-level': { currentValue: 65 },
      'oil-temp': { currentValue: 28 },
      'engine-load': { currentValue: 0 },
    }),
    specs: [
      { label: 'Модель', value: 'DML-1200' },
      { label: 'Серийный номер', value: 'SN-2024-1205' },
      { label: 'Год выпуска', value: '2022' },
      { label: 'Макс. глубина бурения', value: '300 м' },
      { label: 'Диаметр бурения', value: '150-311 мм' },
      { label: 'Мощность двигателя', value: '200 кВт' },
      { label: 'Макс. крутящий момент', value: '600 Нм' },
    ],
    serviceHistory: [
      { date: '2026-02-15', type: 'Капитальный ремонт', status: 'В процессе' },
      { date: '2026-01-22', type: 'Диагностика', status: 'Завершено' },
    ],
  },
  'БУР-19': {
    id: 'БУР-19',
    model: 'СБШ-320',
    fullModel: 'Буровой станок СБШ-320',
    serial: 'E-2024-019',
    year: 2024,
    status: 'working',
    statusLabel: 'В РАБОТЕ',
    sensors: createSensors({
      'temp-engine': { currentValue: 84 },
      speed: { currentValue: 2420 },
      depth: { currentValue: 55.7 },
      pressure: { currentValue: 131 },
      vibration: { currentValue: 0.92 },
      power: { currentValue: 91 },
      torque: { currentValue: 380 },
      'fuel-rate': { currentValue: 20.4 },
      'tool-wear': { currentValue: 58 },
      'oil-level': { currentValue: 89 },
      'oil-temp': { currentValue: 62 },
      'engine-load': { currentValue: 91 },
    }),
    specs: [
      { label: 'Модель', value: 'СБШ-320' },
      { label: 'Серийный номер', value: 'SN-2024-0319' },
      { label: 'Год выпуска', value: '2024' },
      { label: 'Макс. глубина бурения', value: '320 м' },
      { label: 'Диаметр бурения', value: '200-320 мм' },
      { label: 'Мощность двигателя', value: '180 кВт' },
      { label: 'Макс. крутящий момент', value: '500 Нм' },
    ],
    serviceHistory: [
      { date: '2026-02-11', type: 'Плановое ТО', status: 'Завершено' },
      { date: '2026-01-27', type: 'Замена долота', status: 'Завершено' },
      { date: '2026-01-05', type: 'Диагностика', status: 'Завершено' },
    ],
  },
}

export function getEquipmentList() {
  return Object.values(equipmentDb).map(
    ({ sensors: _s, specs: _sp, serviceHistory: _sh, ...rest }) => rest,
  )
}

export function getEquipmentById(id) {
  return equipmentDb[id] || null
}

export function getEquipmentSensors(id) {
  const eq = equipmentDb[id]
  return eq ? eq.sensors : []
}

export function getLiveSensorData(id) {
  const eq = equipmentDb[id]
  if (!eq) return {}

  const result = {}
  for (const sensor of eq.sensors) {
    const variance = (sensor.max - sensor.min) * 0.02
    const drift = (Math.random() - 0.5) * variance * 2
    const value = Math.max(sensor.min, Math.min(sensor.max, sensor.currentValue + drift))
    result[sensor.id] = {
      sensorId: sensor.id,
      value: +value.toFixed(sensor.unit === '°C' || sensor.unit === 'мм/с' ? 1 : 0),
      timestamp: new Date().toISOString(),
    }
  }
  return result
}
